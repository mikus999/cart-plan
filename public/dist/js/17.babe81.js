(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{162:function(e,t,n){(t=n(10)(!1)).push([e.i,".aa[data-v-043991a4]{background:#424242!important}@keyframes blink-data-v-043991a4{0%{background-color:red}50%{background-color:rgba(255,0,0,.5)}to{background-color:red}}@-webkit-keyframes blink-data-v-043991a4{0%{background-color:red}50%{background-color:rgba(255,0,0,.5)}to{background-color:red}}.save-btn[data-v-043991a4]{transition:all .5s ease-in-out;-webkit-animation:blink-data-v-043991a4 1.5s ease-in-out infinite normal;animation:blink-data-v-043991a4 1.5s ease-in-out infinite normal}",""]),e.exports=t},182:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(6),i=n.n(o),u=(n(125),n(11)),l=n(24),c=n(92);function s(e,t,n,a,r,o,i){try{var u=e[o](i),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(a,r)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){s(o,a,r,i,u,"next",e)}function u(e){s(o,a,r,i,u,"throw",e)}i(void 0)}))}}var f={middleware:["auth","teams"],layout:"vuetify",mixins:[u.a],components:{Leaflet:c.a},validations:{tempData:{name:{required:l.required}}},data:function(){return{dialog:!1,isEdit:!1,locationOverlay:!1,headers:[{text:this.$t("teams.location_name"),align:"start",value:"name"},{text:this.$t("teams.location_color"),value:"color_code",align:"center",sortable:!1},{text:this.$t("teams.location_map"),value:"map",sortable:!1},{text:this.$t("general.default"),value:"default",align:"center",sortable:!1},{text:this.$t("general.actions"),value:"actions",sortable:!1}],defaultData:{id:null,team_id:null,name:"",color_code:"#000000",map:null,default:!1},tempData:{name:null},locationData:[],location:null,menu:!1}},computed:{swatchStyle:function(){this.color;var e=this.menu;return{backgroundColor:this.tempData.color_code,cursor:"pointer",height:"20px",width:"20px",borderRadius:e?"50%":"4px",transition:"border-radius 200ms ease-in-out"}},nameErrors:function(){var e=[];return this.$v.tempData.name.$dirty?(!this.$v.tempData.name.required&&e.push(this.$t("teams.location_name_required")),e):e},mapWidth:function(){return this.$vuetify.breakpoint.width<500?this.$vuetify.breakpoint.width-50+"px":"500px"}},created:function(){this.getData()},methods:{getData:function(){var e=this;return d(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.get("/api/teams/"+e.team.id+"/locations/").then((function(t){e.locationData=t.data}));case 2:case"end":return t.stop()}}),t)})))()},deleteLoc:function(e){var t=this;return d(r.a.mark((function n(){var a;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.locationData.indexOf(e.id),n.next=3,t.$root.$confirm(t.$t("teams.confirm_location_delete"),null,"error");case 3:if(!n.sent){n.next=6;break}return n.next=6,i.a.delete("/api/teams/"+t.team.id+"/locations/"+e.id).then((function(e){t.locationData.splice(a,1),t.showSnackbar(t.$t("teams.success_location_delete"),"success")}));case 6:case"end":return n.stop()}}),n)})))()},close:function(){this.dialog=!1},showDialog:function(e,t){t?this.tempData=this.lodash.cloneDeep(e):(this.tempData=this.lodash.cloneDeep(this.defaultData),this.tempData.team_id=this.team.id),this.isEdit=t,this.dialog=!0},createOrUpdate:function(){var e=this;return d(r.a.mark((function t(){var n,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$v.$touch(),e.$v.$invalid){t.next=6;break}return e.isEdit?(n="patch",a="/api/teams/"+e.team.id+"/locations/"+e.tempData.id):(n="post",a="/api/teams/"+e.team.id+"/locations/"),t.next=5,i()({method:n,url:a,data:e.tempData}).then((function(t){e.getData(),e.showSnackbar(e.$t("teams.success_location_update"),"success")}));case 5:e.close();case 6:case"end":return t.stop()}}),t)})))()},updateDefault:function(e){var t=this;return d(r.a.mark((function n(){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i()({method:"post",url:"/api/teams/"+t.team.id+"/locations/"+e+"/makedefault",data:t.tempData}).then((function(e){t.getData(),t.showSnackbar(t.$t("teams.success_location_default"),"success")}));case 2:case"end":return n.stop()}}),n)})))()},showLocationOverlay:function(e){this.location=e,this.locationOverlay=!0}}},p=n(8),v=n(9),m=n.n(v),h=n(103),y=n(221),b=n(5),g=n(231),_=n(640),w=n(660),k=n(639),O=n(661),P=n(113),x=n(225),D=n(232),S=n(659),M=n(657),j=n(51),$=n(42),C=n(23),A=Object(p.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-row",[n("PageTitle",{attrs:{title:e.$tc("teams.cart_location",1)}})],1),e._v(" "),n("v-card",{attrs:{width:"100%"}},[n("v-data-table",{attrs:{headers:e.headers,items:e.locationData,"sort-by":"default, name","sort-desc":""},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",{directives:[{name:"show",rawName:"v-show",value:e.$vuetify.breakpoint.smAndUp,expression:"$vuetify.breakpoint.smAndUp"}]},[e._v(e._s(e.$tc("teams.cart_location",1)))]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{staticClass:"mb-2",attrs:{color:"secondary",block:e.$vuetify.breakpoint.xs},on:{click:function(t){return e.showDialog(e.tempData,!1)}}},[n("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-map-marker-plus")]),e._v("\n            "+e._s(e.$t("teams.create_new_location"))+"\n          ")],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-center"},[n("span",{staticClass:"headline"},[e._v(e._s(e.$tc("teams.cart_location",0)))])]),e._v(" "),n("v-card-text",[n("v-container",[n("v-text-field",{attrs:{"prepend-icon":"mdi-form-textbox",label:e.$t("teams.location_name"),"error-messages":e.nameErrors},on:{blur:function(t){return e.$v.tempData.name.$touch()}},model:{value:e.tempData.name,callback:function(t){e.$set(e.tempData,"name",t)},expression:"tempData.name"}}),e._v(" "),n("v-menu",{attrs:{top:"","nudge-bottom":"105","nudge-left":"16","open-on-click":!0,"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-text-field",e._g({attrs:{label:e.$t("teams.location_color_optional"),"prepend-icon":"mdi-palette","hide-details":""},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[n("v-icon",{attrs:{color:e.tempData.color_code}},[e._v("mdi-square-rounded")])]},proxy:!0}],null,!0),model:{value:e.tempData.color_code,callback:function(t){e.$set(e.tempData,"color_code",t)},expression:"tempData.color_code"}},a))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),n("v-card",[n("v-card-text",{staticClass:"pa-0"},[n("v-color-picker",{attrs:{mode:"hexa",flat:""},model:{value:e.tempData.color_code,callback:function(t){e.$set(e.tempData,"color_code",t)},expression:"tempData.color_code"}})],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.menu=!1}}},[e._v(e._s(e.$t("general.ok")))])],1)],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"grey",text:""},on:{click:e.close}},[e._v(e._s(e.$t("general.cancel")))]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.createOrUpdate}},[e._v("\n                  "+e._s(e.isEdit?e.$t("general.save"):e.$t("general.create"))+"\n                ")])],1)],1)],1)],1)]},proxy:!0},{key:"item.color_code",fn:function(t){var a=t.item;return[n("v-chip",{attrs:{color:a.color_code,small:""}},[e._v(e._s(a.color_code))])]}},{key:"item.map",fn:function(t){var a=t.item;return[n("v-chip",{attrs:{label:"",small:""},on:{click:function(t){return e.showLocationOverlay(a)}}},[e._v("Edit Map")])]}},{key:"item.default",fn:function(t){var a=t.item;return[a.default?n("v-icon",{attrs:{color:"green"}},[e._v("mdi-check-circle")]):n("v-icon",{on:{click:function(t){return t.preventDefault(),e.updateDefault(a.id)}}},[e._v("mdi-circle-outline")])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.showDialog(a,!0)}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-pencil")])],1),e._v(" "),n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.deleteLoc(a)}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1)]}}])})],1),e._v(" "),n("v-overlay",{attrs:{value:e.locationOverlay,dark:"dark"==e.theme},nativeOn:{click:function(t){e.locationOverlay=!1}}},[n("Leaflet",{attrs:{location:e.location,width:e.mapWidth,height:"500px"},on:{close:function(t){e.locationOverlay=!1}},nativeOn:{click:function(e){e.stopPropagation()}}})],1)],1)}),[],!1,null,null,null);t.default=A.exports;m()(A,{VBtn:h.a,VCard:y.a,VCardActions:b.a,VCardText:b.c,VCardTitle:b.d,VChip:g.a,VColorPicker:_.a,VContainer:w.a,VDataTable:k.a,VDialog:O.a,VIcon:P.a,VMenu:x.a,VOverlay:D.a,VRow:S.a,VSpacer:M.a,VTextField:j.a,VToolbar:$.a,VToolbarTitle:C.a})},24:function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"alpha",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"alphaNum",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"numeric",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"between",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"email",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"ipAddress",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"macAddress",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"maxLength",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"minLength",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"required",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"requiredIf",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"requiredUnless",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"sameAs",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"url",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"or",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"and",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"not",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"minValue",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"maxValue",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"integer",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"decimal",{enumerable:!0,get:function(){return P.default}}),t.helpers=void 0;var r=S(n(482)),o=S(n(485)),i=S(n(486)),u=S(n(487)),l=S(n(488)),c=S(n(489)),s=S(n(490)),d=S(n(491)),f=S(n(492)),p=S(n(493)),v=S(n(494)),m=S(n(495)),h=S(n(496)),y=S(n(497)),b=S(n(498)),g=S(n(499)),_=S(n(500)),w=S(n(501)),k=S(n(502)),O=S(n(503)),P=S(n(504)),x=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=D();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(28));function D(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return D=function(){return e},e}function S(e){return e&&e.__esModule?e:{default:e}}t.helpers=x},28:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"withParams",{enumerable:!0,get:function(){return r.default}}),t.regex=t.ref=t.len=t.req=void 0;var a,r=(a=n(483))&&a.__esModule?a:{default:a};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=function(e){if(Array.isArray(e))return!!e.length;if(null==e)return!1;if(!1===e)return!0;if(e instanceof Date)return!isNaN(e.getTime());if("object"===o(e)){for(var t in e)return!0;return!1}return!!String(e).length};t.req=i;t.len=function(e){return Array.isArray(e)?e.length:"object"===o(e)?Object.keys(e).length:String(e).length};t.ref=function(e,t,n){return"function"==typeof e?e.call(t,n):n[e]};t.regex=function(e,t){return(0,r.default)({type:e},(function(e){return!i(e)||t.test(e)}))}},482:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("alpha",/^[a-zA-Z]*$/);t.default=a},483:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a="web"===e.env.BUILD?n(484).withParams:n(284).withParams;t.default=a}).call(this,n(117))},484:function(e,t,n){"use strict";(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.withParams=void 0;var a="undefined"!=typeof window?window:void 0!==e?e:{},r=a.vuelidate?a.vuelidate.withParams:function(e,t){return"object"===n(e)&&void 0!==t?t:e((function(){}))};t.withParams=r}).call(this,n(59))},485:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("alphaNum",/^[a-zA-Z0-9]*$/);t.default=a},486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("numeric",/^[0-9]*$/);t.default=a},487:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e,t){return(0,a.withParams)({type:"between",min:e,max:t},(function(n){return!(0,a.req)(n)||(!/\s/.test(n)||n instanceof Date)&&+e<=+n&&+t>=+n}))}},488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("email",/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/);t.default=a},489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28),r=(0,a.withParams)({type:"ipAddress"},(function(e){if(!(0,a.req)(e))return!0;if("string"!=typeof e)return!1;var t=e.split(".");return 4===t.length&&t.every(o)}));t.default=r;var o=function(e){if(e.length>3||0===e.length)return!1;if("0"===e[0]&&"0"!==e)return!1;if(!e.match(/^\d+$/))return!1;var t=0|+e;return t>=0&&t<=255}},490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return(0,a.withParams)({type:"macAddress"},(function(t){if(!(0,a.req)(t))return!0;if("string"!=typeof t)return!1;var n="string"==typeof e&&""!==e?t.split(e):12===t.length||16===t.length?t.match(/.{2}/g):null;return null!==n&&(6===n.length||8===n.length)&&n.every(r)}))};var r=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)}},491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"maxLength",max:e},(function(t){return!(0,a.req)(t)||(0,a.len)(t)<=e}))}},492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"minLength",min:e},(function(t){return!(0,a.req)(t)||(0,a.len)(t)>=e}))}},493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28),r=(0,a.withParams)({type:"required"},(function(e){return"string"==typeof e?(0,a.req)(e.trim()):(0,a.req)(e)}));t.default=r},494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"requiredIf",prop:e},(function(t,n){return!(0,a.ref)(e,this,n)||(0,a.req)(t)}))}},495:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"requiredUnless",prop:e},(function(t,n){return!!(0,a.ref)(e,this,n)||(0,a.req)(t)}))}},496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"sameAs",eq:e},(function(t,n){return t===(0,a.ref)(e,this,n)}))}},497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("url",/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);t.default=a},498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.withParams)({type:"or"},(function(){for(var e=this,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t.length>0&&t.reduce((function(t,n){return t||n.apply(e,a)}),!1)}))}},499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.withParams)({type:"and"},(function(){for(var e=this,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t.length>0&&t.reduce((function(t,n){return t&&n.apply(e,a)}),!0)}))}},500:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"not"},(function(t,n){return!(0,a.req)(t)||!e.call(this,t,n)}))}},501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"minValue",min:e},(function(t){return!(0,a.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t>=+e}))}},502:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(28);t.default=function(e){return(0,a.withParams)({type:"maxValue",max:e},(function(t){return!(0,a.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t<=+e}))}},503:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("integer",/(^[0-9]*$)|(^-[0-9]+$)/);t.default=a},504:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n(28).regex)("decimal",/^[-]?\d*(\.\d+)?$/);t.default=a},92:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(6),i=n.n(o),u=n(11),l=(n(506),n(19)),c=n.n(l),s=n(634),d=n(635),f=n(636),p=n(637);n(507),n(508),n(509);function v(e,t,n,a,r,o,i){try{var u=e[o](i),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(a,r)}delete c.a.Icon.Default.prototype._getIconUrl,c.a.Icon.Default.mergeOptions({iconRetinaUrl:"/images/leaflet/marker-icon-2x.png",iconUrl:"/images/leaflet/marker-icon.png",shadowUrl:"/images/leaflet/marker-shadow.png"});var m={name:"Leaflet",mixins:[u.a],components:{LMap:s.a,LTileLayer:d.a,LControl:f.a,LMarker:p.a},props:{location:{type:Object},readonly:{type:Boolean,default:!1},width:{type:[String,Number],default:"500px"},height:{type:[String,Number],default:"500px"},fill:{type:String,default:"#777777"}},data:function(){return{map:null,url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',edited:null,center:Object(l.latLng)(1,1),zoom:13,shapeOptions:{fillColor:this.getFill,fillOpacity:.4,stroke:!0,weight:2,color:"#999999",editable:!0,clickable:!0,bubblingMouseEvents:!1},markerOptions:{draggable:!0,clickable:!0,bubblingMouseEvents:!1},locatorOptions:{enableHighAccuracy:!0},closeBtn:{display:"fixed",top:"50px",left:"50px",zIndex:"500"},mapDraggable:this.readonly,mapCursor:this.readonly?null:"default",mapType:"roadmap",drawingMode:0,dataLayer:null,geoJson:null,selectedShape:null,isChanged:null,drawingManager:null,shapes:null,drawControl:null,drawMode:null,drawFeature:null}},computed:{getFill:function(){return this.fill?this.fill:this.location.color_code}},created:function(){},mounted:function(){this.closeBtn.left=this.$refs.mainDiv.clientWidth-50+"px"},methods:{onMapReady:function(){this.map=this.$refs.map.mapObject,null===this.location.map&&this.getMyPosition(),this.loadDrawControl()},getMyPosition:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.center=Object(l.latLng)(t.coords.latitude,t.coords.longitude)}),null,this.locatorOptions)},recenterMap:function(){this.map.fitBounds(this.shapes.getBounds())},loadDrawControl:function(){var e=this;this.drawControl=new c.a.Control.Draw({draw:!1}),this.map.addControl(this.drawControl),this.map.addControl(new c.a.Control.Fullscreen),this.shapes=new c.a.FeatureGroup,this.map.addLayer(this.shapes),this.map.on(c.a.Draw.Event.CREATED,(function(t){var n=t.layerType,a=t.layer,r=a.feature=a.feature||{};r.type="Feature",r.properties=r.properties||{},r.properties.shape=n,"circle"==n&&(r.properties.radius=a.getRadius()),e.setShapeEvents(a),e.shapes.addLayer(a),e.drawMode=null})),this.map.on("click",(function(t){e.clearSelection()})),document.addEventListener("keydown",(function(t){switch(t.key){case"Delete":case"Backspace":e.deleteSelection();break;case"Escape":e.clearSelection()}})),this.loadGeoJSON()},setShapeEvents:function(e){var t=this;this.readonly||e.on("click",(function(e){c.a.DomEvent.stopPropagation(e),t.setSelection(e.sourceTarget)}))},updateMapType:function(){switch(this.mapType){case"satellite":this.url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",this.attribution='&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',this.mapType="roadmap";break;case"roadmap":this.url="https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",this.attribution="Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",this.mapType="satellite"}},changeDrawingMode:function(e){if(this.drawMode===e)this.drawMode=null,this.drawFeature.disable(),this.drawFeature=null;else{switch(null!==this.drawFeature&&(this.drawFeature.disable(),this.drawFeature=null),e){case"polygon":this.drawFeature=new c.a.Draw.Polygon(this.map,this.shapeOptions);break;case"rectangle":this.drawFeature=new c.a.Draw.Rectangle(this.map,this.shapeOptions);break;case"circle":this.drawFeature=new c.a.Draw.Circle(this.map,this.shapeOptions);break;case"marker":this.drawFeature=new c.a.Draw.Marker(this.map,this.markerOptions)}this.drawMode=e,this.drawFeature.enable()}},isActiveButton:function(e){var t=null;return null!==this.drawMode&&this.drawMode===e&&(t=!0),t},revertChanges:function(){this.shapes.clearLayers(),this.loadGeoJSON()},loadGeoJSON:function(){if(null!==this.location.map){var e=JSON.parse(this.location.map);c.a.geoJson(e,{style:this.shapeOptions,pointToLayer:function(e,t){return e.properties.radius?new c.a.Circle(t,e.properties.radius):new c.a.Marker(t)},onEachFeature:this.loadFeature});this.recenterMap()}this.isChanged=null},loadFeature:function(e,t){"rectangle"===e.properties.shape&&(t=new c.a.Rectangle(t.getLatLngs())),this.setShapeEvents(t),this.shapes.addLayer(t)},saveShapes:function(){this.saveToDB()},saveToDB:function(){var e,t=this;return(e=r.a.mark((function e(){var n,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lodash.cloneDeep(t.location),a="/api/teams/"+t.team.id+"/locations/"+n.id,o=null,t.shapes.getLayers().length>0&&(o=JSON.stringify(t.shapes.toGeoJSON())),t.location.map=o,n.map=o,e.next=9,i()({method:"patch",url:a,data:n}).then((function(e){t.recenterMap(),t.showSnackbar(t.$t("teams.success_location_update"),"success"),t.isChanged=null}));case 9:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){v(o,a,r,i,u,"next",e)}function u(e){v(o,a,r,i,u,"throw",e)}i(void 0)}))})()},setSelection:function(e){this.clearSelection(),e.editing.enabled()?(this.selectedShape=null,e.editing.disable()):(this.selectedShape=e,e.editing.enable())},clearSelection:function(){this.shapes.eachLayer((function(e){e.editing.disable()})),this.selectedShape=null,this.drawMode=null},deleteSelection:function(){null!==this.selectedShape&&(this.shapes.removeLayer(this.selectedShape),this.selectedShape=null)}}},h=n(2),y=n.n(h),b=n(162),g=n.n(b),_={insert:"head",singleton:!1},w=(y()(g.a,_),g.a.locals,n(8)),k=n(9),O=n.n(k),P=n(103),x=n(113),D=n(31),S=n(657),M=n(42),j=Object(w.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"mainDiv"},[e.readonly?n("v-btn",{style:e.closeBtn,attrs:{fab:"",small:"",color:"primary"},on:{click:function(t){return e.$emit("close")}}},[n("v-icon",[e._v("mdi-close")])],1):n("v-toolbar",{attrs:{dense:"",dark:""}},[n("v-item-group",{staticClass:"v-btn-toggle"},[n("v-btn",{on:{click:function(t){return e.updateMapType()}}},[n("v-icon",[e._v(e._s("roadmap"===e.mapType?"mdi-satellite":"mdi-map"))])],1)],1),e._v(" "),n("v-spacer"),e._v(" "),n("v-item-group",{staticClass:"v-btn-toggle",attrs:{right:""}},[n("v-btn",{attrs:{"input-value":e.isActiveButton("marker")},on:{click:function(t){return e.changeDrawingMode("marker")}}},[n("v-icon",[e._v("mdi-map-marker")])],1),e._v(" "),n("v-btn",{attrs:{"input-value":e.isActiveButton("rectangle")},on:{click:function(t){return e.changeDrawingMode("rectangle")}}},[n("v-icon",[e._v("mdi-vector-rectangle")])],1),e._v(" "),n("v-btn",{attrs:{"input-value":e.isActiveButton("polygon")},on:{click:function(t){return e.changeDrawingMode("polygon")}}},[n("v-icon",[e._v("mdi-vector-polygon")])],1),e._v(" "),n("v-btn",{attrs:{"input-value":e.isActiveButton("circle")},on:{click:function(t){return e.changeDrawingMode("circle")}}},[n("v-icon",[e._v("mdi-vector-circle")])],1)],1),e._v(" "),n("v-spacer"),e._v(" "),n("v-item-group",{staticClass:"v-btn-toggle",attrs:{right:""}},[n("v-btn",{on:{click:function(t){return e.deleteSelection()}}},[n("v-icon",[e._v("mdi-delete")])],1),e._v(" "),n("v-btn",{attrs:{"input-value":e.isChanged,"active-class":"save-btn"},on:{click:function(t){return e.saveShapes()}}},[n("v-icon",[e._v("mdi-content-save")])],1),e._v(" "),n("v-btn",{on:{click:function(t){return e.revertChanges()}}},[n("v-icon",[e._v("mdi-undo")])],1)],1)],1),e._v(" "),n("l-map",{ref:"map",style:"width: "+e.width+"; height: "+e.height,attrs:{center:e.center,zoom:e.zoom},on:{ready:function(t){return e.onMapReady()}}},[n("l-tile-layer",{attrs:{url:e.url,attribution:e.attribution}})],1)],1)}),[],!1,null,"043991a4",null);t.a=j.exports;O()(j,{VBtn:P.a,VIcon:x.a,VItemGroup:D.b,VSpacer:S.a,VToolbar:M.a})}}]);