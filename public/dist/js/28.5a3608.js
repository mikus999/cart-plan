(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{167:function(t,e,s){"use strict";s.r(e);var a=s(6),n=s.n(a),i=s(11),r=s(1),l=s.n(r),c=s(73);function u(t,e,s,a,n,i,r){try{var l=t[i](r),c=l.value}catch(t){return void s(t)}l.done?e(c):Promise.resolve(c).then(a,n)}function o(t){return function(){var e=this,s=arguments;return new Promise((function(a,n){var i=t.apply(e,s);function r(t){u(i,a,n,r,l,"next",t)}function l(t){u(i,a,n,r,l,"throw",t)}r(void 0)}))}}var d={middleware:["auth","teams"],layout:"vuetify",mixins:[i.a],components:{ShiftCard:c.a},data:function(){return{tab:null,shifts:null,schedules:null,schedule:null,hover:!1}},computed:{cardWidth:function(){var t=null;switch(this.$vuetify.breakpoint.name){case"xs":t="100%";break;case"sm":t="29%";break;case"md":t="22%";break;case"xl":t="16%";break;default:t="22%"}return t}},created:function(){this.getSchedData()},methods:{getSchedData:function(){var t=this;return o(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.get("/api/schedules/"+t.team.id).then((function(e){t.schedules=e.data,t.schedules=t.schedules.filter((function(t){return["1","2"].indexOf(t.status)>-1}));var s=t.$dayjs().subtract(8,"d").format("YYYY-MM-DD");t.schedules=t.schedules.filter((function(t){return t.date_start>=s})),void 0!==t.schedules[0]&&(t.schedule=t.schedules[0],t.getShiftData())}));case 2:case"end":return e.stop()}}),e)})))()},getShiftData:function(){var t=this;return o(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.get("/api/schedules/"+t.schedule.id+"/shifts").then((function(e){t.tab=0,t.shifts=e.data}));case 2:case"end":return e.stop()}}),e)})))()},dayOfWeek:function(t){var e=[];return(e=this.$dayjs().localeData().weekdaysShort())[7]=e[0],e[t]},filterShifts:function(t,e){var s=this,a=null;return null!==t&&(a=t.filter((function(t){return s.$dayjs(t.time_start).day()==e}))),a}}},h=s(8),f=s(9),v=s.n(f),m=s(662),p=s(221),_=s(113),w=s(659),b=s(132),y=s(633),D=s(644),k=s(641),S=s(319),x=s(42),Y=Object(h.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{attrs:{width:"100%"}},[s("v-toolbar",{attrs:{flat:"",extended:"",height:"80"},scopedSlots:t._u([{key:"extension",fn:function(){return[null!==t.schedule?s("v-tabs",{attrs:{centered:"","align-with-title":"","fixed-tabs":"","show-arrows":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(7,(function(e){return s("v-tab",{key:e},[s("v-badge",{attrs:{color:"secondary",value:t.filterShifts(t.shifts,e)?t.filterShifts(t.shifts,e).length:null,content:t.filterShifts(t.shifts,e)?t.filterShifts(t.shifts,e).length:null,"offset-x":"-3px"}},[t._v("\n            "+t._s(t.dayOfWeek(e))+"\n          ")])],1)})),1):t._e()]},proxy:!0}])},[s("v-select",{staticClass:"mt-10",attrs:{outlined:"",items:t.schedules,"item-value":"id","item-text":"date_start","return-object":"","prepend-icon":"mdi-calendar-week-begin",label:t.$t("schedules.week_of")},on:{change:t.getShiftData},scopedSlots:t._u([{key:"selection",fn:function(e){var a=e.item;return[a?s("div",[s("v-icon",{attrs:{color:1==a.status?"green":"red"}},[t._v("mdi-circle")]),t._v("\n          "+t._s(a.date_start)),t.$vuetify.breakpoint.smAndUp?s("span",[t._v(": "+t._s(t.scheduleStatus[a.status].text_user))]):t._e()],1):t._e()]}},{key:"item",fn:function(e){var a=e.item;return[a?s("div",[s("v-icon",{attrs:{color:1==a.status?"green":"red"}},[t._v("mdi-circle")]),t._v("\n          "+t._s(a.date_start)),t.$vuetify.breakpoint.smAndUp?s("span",[t._v(": "+t._s(t.scheduleStatus[a.status].text_user))]):t._e()],1):t._e()]}}]),model:{value:t.schedule,callback:function(e){t.schedule=e},expression:"schedule"}})],1),t._v(" "),s("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(7,(function(e){return s("v-tab-item",{key:e},[s("v-row",{staticClass:"ma-2"},t._l(t.filterShifts(t.shifts,e),(function(e){return s("ShiftCard",{key:e.id,staticClass:"ma-3",attrs:{shift:e,schedule:t.schedule,width:t.cardWidth}})})),1)],1)})),1)],1)}),[],!1,null,null,null),g=Y.exports;v()(Y,{VBadge:m.a,VCard:p.a,VIcon:_.a,VRow:w.a,VSelect:b.a,VTab:y.a,VTabItem:D.a,VTabs:k.a,VTabsItems:S.a,VToolbar:x.a});function $(t,e,s,a,n,i,r){try{var l=t[i](r),c=l.value}catch(t){return void s(t)}l.done?e(c):Promise.resolve(c).then(a,n)}function M(t){return function(){var e=this,s=arguments;return new Promise((function(a,n){var i=t.apply(e,s);function r(t){$(i,a,n,r,l,"next",t)}function l(t){$(i,a,n,r,l,"throw",t)}r(void 0)}))}}var V={middleware:["auth","teams"],layout:"vuetify",mixins:[i.a],components:{ShiftCard:c.a},data:function(){return{tab:null,shifts:[],schedules:null,schedule:null,hover:!1,availableDates:[],selectedDates:[],shiftsFiltered:[],showAllNone:!0}},computed:{calendarHeader:function(){var t="";return t+=this.$t("schedules.shifts_displayed")+": "+this.shiftsFiltered.length},sortedShifts:function(){return this.shiftsFiltered.sort((function(t,e){return new Date(t.time_start)-new Date(e.time_start)})),this.shiftsFiltered},cardWidth:function(){var t=null;switch(this.$vuetify.breakpoint.name){case"xs":t="100%";break;case"sm":t="29%";break;case"md":t="22%";break;case"xl":t="16%";break;default:t="22%"}return t}},created:function(){this.getSchedData()},methods:{allowedDates:function(t){return this.availableDates.indexOf(t)>-1},dayShifts:function(t){var e=this;if(this.shifts){var s=this.shifts.filter((function(s){return e.$dayjs(s.time_start).format("YYYY-MM-DD")==t}));if(s.length>0){var a=[];return s.forEach((function(t){a.indexOf(t.location.color_code)<0&&a.push(t.location.color_code)})),a}return!1}},getSchedData:function(){var t=this;return M(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.get("/api/schedules/"+t.team.id).then((function(e){t.schedules=e.data,t.schedules=t.schedules.filter((function(t){return["1","2"].indexOf(t.status)>-1}));var s=t.$dayjs().subtract(8,"d").format("YYYY-MM-DD");t.schedules=t.schedules.filter((function(t){return t.date_start>=s})),t.schedules.forEach((function(e){t.getShiftData(e)}))}));case 2:case"end":return e.stop()}}),e)})))()},getShiftData:function(t){var e=this;return M(l.a.mark((function s(){return l.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.a.get("/api/schedules/"+t.id+"/shifts").then((function(t){Array.prototype.push.apply(e.shifts,t.data),t.data.forEach((function(t){e.availableDates.push(e.$dayjs(t.time_start).format("YYYY-MM-DD")),e.selectedDates.push(e.$dayjs(t.time_start).format("YYYY-MM-DD")),e.filterShifts()}))}));case 2:case"end":return s.stop()}}),s)})))()},dayOfWeek:function(t){var e=[];return(e=this.$dayjs().localeData().weekdaysShort())[7]=e[0],e[t]},filterShifts:function(){var t=this;this.selectedDates.length>0?this.shiftsFiltered=this.shifts.filter((function(e){return t.selectedDates.indexOf(t.$dayjs(e.time_start).format("YYYY-MM-DD"))>-1})):this.shiftsFiltered=[]},toggleShowAllNone:function(){var t=this;this.showAllNone=!this.showAllNone,this.showAllNone?this.shifts.forEach((function(e){t.availableDates.push(t.$dayjs(e.time_start).format("YYYY-MM-DD")),t.selectedDates.push(t.$dayjs(e.time_start).format("YYYY-MM-DD")),t.filterShifts()})):(this.selectedDates=[],this.shiftsFiltered=[])}}},j=s(103),C=s(638),A=Object(h.a)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{attrs:{width:"100%"}},[s("v-date-picker",{attrs:{"allowed-dates":t.allowedDates,events:t.dayShifts,locale:t.locale,"first-day-of-week":t.$dayjs().localeData().firstDayOfWeek(),"no-title":"",multiple:"",width:"100%"},on:{"click:date":t.filterShifts},model:{value:t.selectedDates,callback:function(e){t.selectedDates=e},expression:"selectedDates"}}),t._v(" "),s("v-btn",{attrs:{block:"",color:"primary"},on:{click:t.toggleShowAllNone}},[s("v-icon",{staticClass:"mr-2",attrs:{small:""}},[t._v(t._s(t.showAllNone?"mdi-eye-off":"mdi-eye"))]),t._v("\n    "+t._s(t.showAllNone?t.$t("schedules.show_none"):t.$t("schedules.show_all"))+"\n  ")],1),t._v(" "),s("v-row",{staticClass:"mb-2 mt-6"},[s("span",{staticClass:"mx-auto text-overline"},[t._v(t._s(t.calendarHeader))])]),t._v(" "),s("v-row",{staticClass:"ma-2"},t._l(t.sortedShifts,(function(e){return s("ShiftCard",{key:e.id,staticClass:"ma-3",attrs:{shift:e,schedule:e.schedule,width:t.cardWidth}})})),1)],1)}),[],!1,null,null,null),O=A.exports;v()(A,{VBtn:j.a,VCard:p.a,VDatePicker:C.a,VIcon:_.a,VRow:w.a});var N={middleware:["auth","teams"],layout:"vuetify",mixins:[i.a],components:{ShiftSchedule:g,ShiftScheduleMobile:O}},W=s(660),E=Object(h.a)(N,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",{attrs:{fluid:""}},[e("v-row",[e("PageTitle",{attrs:{title:this.$t("schedules.shift_schedules")}})],1),this._v(" "),e("v-row",[this.$vuetify.breakpoint.smAndUp?e("ShiftSchedule"):e("ShiftScheduleMobile")],1)],1)}),[],!1,null,null,null);e.default=E.exports;v()(E,{VContainer:W.a,VRow:w.a})},17:function(t,e,s){"use strict";var a=s(103);e.a=a.a}}]);