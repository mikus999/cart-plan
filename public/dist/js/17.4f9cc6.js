(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{141:function(t,e,r){"use strict";r.r(e);var n=r(1),a=r.n(n),s=r(6),i=r.n(s);function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){o=!0,s=t},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw s}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e,r,n,a,s,i){try{var o=t[s](i),c=o.value}catch(t){return void r(t)}o.done?e(c):Promise.resolve(c).then(n,a)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var s=t.apply(e,r);function i(t){u(s,n,a,i,o,"next",t)}function o(t){u(s,n,a,i,o,"throw",t)}i(void 0)}))}}var f={middleware:["auth","teams"],layout:"vuetify",mixins:[r(17).a],props:{id:{type:[String,Number],required:!0}},components:{},data:function(){return{dialog:!1,date:"",schedData:[],shiftData:[],shiftHeaders:[{text:this.$t("shifts.day"),align:"start",value:"day"},{text:this.$t("shifts.shift_time"),align:"start",value:"shift_time"},{text:this.$t("shifts.location"),value:"location",align:"center"},{text:this.$t("shifts.assignments"),value:"assignments",align:"start",sortable:!1,width:"50%"}],teamUsers:[],shiftUsers:{}}},created:function(){this.initialize()},methods:{initialize:function(){this.getSchedData(),this.getShiftData(),this.getTeamUsers()},getSchedData:function(){var t=this;return l(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get("/api/schedules/show/"+t.id).then((function(e){t.schedData=e.data,t.date=t.$dayjs(t.schedData.date_start).format("YYYY-MM-DD")}));case 2:case"end":return e.stop()}}),e)})))()},getShiftData:function(){var t=this;return l(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get("/api/schedules/"+t.id+"/shifts").then((function(e){t.shiftData=e.data;var r,n=o(e.data);try{for(n.s();!(r=n.n()).done;){var a=r.value;t.shiftUsers[a.id]=a.users}}catch(t){n.e(t)}finally{n.f()}}));case 2:case"end":return e.stop()}}),e)})))()},getTeamUsers:function(t){var e=this;return l(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.get("/api/teams/users/"+e.team.id).then((function(t){e.teamUsers=t.data}));case 2:case"end":return t.stop()}}),t)})))()},removeShiftUser:function(t,e){return l(a.a.mark((function r(){var n;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.item,t.attrs,r.next=4,i()({method:"post",url:"/api/schedules/leaveshift",data:{user_id:n.id,shift_id:e.id}}).then((function(t){e.users=t.data.shiftusers}));case 4:case"end":return r.stop()}}),r)})))()},addShiftUser:function(t,e){var r=this;return l(a.a.mark((function n(){var s,o,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=t.item,o=t.attrs,c=r.team.setting_shift_assignment_autoaccept?2:0,"true"!==o["aria-selected"]){n.next=7;break}r.removeShiftUser(t,e),n.next=9;break;case 7:return n.next=9,i()({method:"post",url:"/api/schedules/joinshift",data:{user_id:s.id,shift_id:e.id,status:c}}).then((function(t){s.pivot.status=c,e.users=t.data.shiftusers}));case 9:case"end":return n.stop()}}),n)})))()},checkMax:function(t,e){var r="grey darken-3";return t===e?r="green":t<e&&(r="red darken-4"),r}}},d=(r(384),r(5)),v=r(13),m=r.n(v),h=r(87),p=r(157),_=r(155),b=r(598),g=r(630),y=r(612),x=r(75),k=r(158),w=r(23),S=r(599),$=r(109),U=r(37),D=r(24),V=Object(d.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("v-row",[r("PageTitle",{attrs:{title:t.$t("schedules.schedule")}})],1),t._v(" "),r("v-card",{attrs:{width:"100%"}},[r("v-row",[r("v-col",{staticClass:"text-left",attrs:{xs:"1",sm:"4"}},[r("v-btn",{attrs:{text:"","x-large":t.$vuetify.breakpoint.smAndUp},on:{click:function(e){return t.$router.go(-1)}}},[r("v-icon",{attrs:{left:""}},[t._v("mdi-arrow-left")]),t._v(" "),t.$vuetify.breakpoint.smAndUp?r("span",[t._v(t._s(t.$t("general.go_back")))]):t._e()],1)],1),t._v(" "),r("v-col",{staticClass:"text-center",attrs:{xs:"10",sm:"4"}},[r("span",{staticClass:"text-h6"},[t._v(t._s(t.$t("schedules.week_of"))+" "+t._s(t._f("formatDate")(t.schedData.date_start)))])]),t._v(" "),r("v-col",{staticClass:"text-right",attrs:{xs:"1",sm:"4"}},[r("v-btn",{attrs:{text:"","x-large":t.$vuetify.breakpoint.smAndUp},on:{click:function(t){}}},[t.$vuetify.breakpoint.smAndUp?r("span",[t._v(t._s(t.$t("schedules.approvals")))]):t._e(),t._v(" "),r("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-right")])],1)],1)],1),t._v(" "),r("v-row",[r("v-col",{attrs:{md:"12"}},[r("v-data-table",{attrs:{headers:t.shiftHeaders,items:t.shiftData,"sort-by":"time_start","sort-asc":""},scopedSlots:t._u([{key:"top",fn:function(){return[r("v-toolbar",{attrs:{flat:""}},[r("v-toolbar-title",[t._v(t._s(t.$t("schedules.assignments")))])],1)]},proxy:!0},{key:"item.day",fn:function(e){var r=e.item;return[t._v("\n            "+t._s(t._f("formatDay")(r.time_start))+"\n          ")]}},{key:"item.shift_time",fn:function(e){var r=e.item;return[t._v("\n            "+t._s(t._f("formatTime")(r.time_start))+" - "+t._s(t._f("formatTime")(r.time_end))+"\n          ")]}},{key:"item.location",fn:function(e){var n=e.item;return[r("v-chip",{attrs:{label:"",small:"",color:n.location.color_code}},[t._v(t._s(n.location.name))])]}},{key:"item.assignments",fn:function(e){var n=e.item;return[r("v-select",{staticClass:"no-border",attrs:{items:t.teamUsers,readonly:n.max_participants<=n.users.length||!t.$can("manage_schedules"),"hide-details":"",multiple:"","return-object":"","item-text":"name","item-value":"id",id:"shift"+n.id},scopedSlots:t._u([{key:"prepend-inner",fn:function(){return[r("v-chip",{attrs:{small:"",label:"",color:t.checkMax(n.max_participants,n.users.length)}},[t._v(t._s(n.users.length)+"/"+t._s(n.max_participants))])]},proxy:!0},{key:"selection",fn:function(e){return[r("v-chip",t._b({attrs:{small:"",label:"","input-value":e.selected,close:"",color:void 0!==n.users[e.index].pivot.status?t.shiftStatus[n.users[e.index].pivot.status].color:""},on:{"click:close":function(r){return t.removeShiftUser(e,n)}}},"v-chip",e.attrs,!1),[t._v("\n                  "+t._s(e.item.name)+"\n                ")])]}},{key:"item",fn:function(e){return[r("v-list-item-avatar",[r("v-icon",{attrs:{color:"true"===e.attrs["aria-selected"]?"green":"red"}},[t._v("mdi-checkbox-blank-circle")])],1),t._v(" "),r("v-list-item-content",{on:{click:function(r){return t.addShiftUser(e,n)}}},[r("v-list-item-title",[t._v(t._s(e.item.name))]),t._v(" "),r("v-list-item-subtitle")],1)]}}],null,!0),model:{value:n.users,callback:function(e){t.$set(n,"users",e)},expression:"item.users"}})]}}])})],1)],1)],1)],1)}),[],!1,null,null,null);e.default=V.exports;m()(V,{VBtn:h.a,VCard:p.a,VChip:_.a,VCol:b.a,VContainer:g.a,VDataTable:y.a,VIcon:x.a,VListItemAvatar:k.a,VListItemContent:w.a,VListItemSubtitle:w.b,VListItemTitle:w.c,VRow:S.a,VSelect:$.a,VToolbar:U.a,VToolbarTitle:D.a})},384:function(t,e,r){"use strict";var n=r(98);r.n(n).a},385:function(t,e,r){(t.exports=r(7)(!1)).push([t.i,"\n.no-border.v-text-field>.v-input__control>.v-input__slot:before {\n    border-style: none;\n}\n.no-border.v-text-field>.v-input__control>.v-input__slot:after {\n    border-style: none;\n}\n",""])},598:function(t,e,r){"use strict";r(126);var n=r(4),a=r.n(n),s=r(22),i=r(0);const o=["sm","md","lg","xl"],c=o.reduce((t,e)=>(t[e]={type:[Boolean,String,Number],default:!1},t),{}),u=o.reduce((t,e)=>(t["offset"+Object(i.G)(e)]={type:[String,Number],default:null},t),{}),l=o.reduce((t,e)=>(t["order"+Object(i.G)(e)]={type:[String,Number],default:null},t),{}),f={col:Object.keys(c),offset:Object.keys(u),order:Object.keys(l)};function d(t,e,r){let n=t;if(null!=r&&!1!==r){if(e){n+="-"+e.replace(t,"")}return"col"!==t||""!==r&&!0!==r?(n+="-"+r,n.toLowerCase()):n.toLowerCase()}}const v=new Map;e.a=a.a.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...c,offset:{type:[String,Number],default:null},...u,order:{type:[String,Number],default:null},...l,alignSelf:{type:String,default:null,validator:t=>["auto","start","end","center","baseline","stretch"].includes(t)},tag:{type:String,default:"div"}},render(t,{props:e,data:r,children:n,parent:a}){let i="";for(const t in e)i+=String(e[t]);let o=v.get(i);if(!o){let t;for(t in o=[],f)f[t].forEach(r=>{const n=e[r],a=d(t,r,n);a&&o.push(a)});const r=o.some(t=>t.startsWith("col-"));o.push({col:!r||!e.cols,["col-"+e.cols]:e.cols,["offset-"+e.offset]:e.offset,["order-"+e.order]:e.order,["align-self-"+e.alignSelf]:e.alignSelf}),v.set(i,o)}return t(e.tag,Object(s.a)(r,{class:o}),n)}})},98:function(t,e,r){var n=r(385);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(8)(n,a);n.locals&&(t.exports=n.locals)}}]);