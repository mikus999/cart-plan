(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{85:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(6),r=a.n(c);a(125);function i(e,t,a,n,s,c,r){try{var i=e[c](r),o=i.value}catch(e){return void a(e)}i.done?t(o):Promise.resolve(o).then(n,s)}function o(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var c=e.apply(t,a);function r(e){i(c,n,s,r,o,"next",e)}function o(e){i(c,n,s,r,o,"throw",e)}r(void 0)}))}}var l={middleware:["auth","teams"],layout:"vuetify",mixins:[a(11).a],data:function(){return{dialog:!1,schedHeaders:[{text:this.$t("schedules.status"),align:"start",value:"status"},{text:this.$t("schedules.start_date"),value:"date_start"},{text:this.$t("schedules.shifts"),value:"shifts_count",align:"center",sortable:!1},{text:this.$t("schedules.template_name"),value:"schedule_template_id",sortable:!1},{text:this.$t("general.actions"),value:"actions",sortable:!1}],schedData:[],newSchedDate:"",date:(new Date).toISOString().substr(0,10),menu:!1}},created:function(){this.getSchedData()},methods:{getDayIcon:function(e){return e?"mdi-check-bold":"mdi-close-thick"},getDayColor:function(e){return e?"green":"red"},allowedDates:function(e){return 1===this.$dayjs(e).day()},getSchedData:function(){var e=this;return o(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.get("/api/schedules/"+e.team.id).then((function(t){e.schedData=t.data}));case 2:case"end":return t.stop()}}),t)})))()},editSched:function(e){this.$router.push({name:"schedules.edit",params:{id:e.id}})},editAssignments:function(e){this.$router.push({name:"schedules.assignments",params:{id:e.id}})},deleteSched:function(e){var t=this;return o(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.schedData.indexOf(e.id),a.next=3,t.$root.$confirm(t.$t("schedules.confirm_delete_schedule"),null,"error");case 3:if(!a.sent){a.next=6;break}return a.next=6,r.a.delete("/api/schedules/"+e.id).then((function(e){t.showSnackbar(t.$t("schedules.success_delete_schedule"),"success"),t.getSchedData()}));case 6:case"end":return a.stop()}}),a)})))()},close:function(){this.dialog=!1},save:function(){var e=this;if(""!==this.newSchedDate){this.newSchedDate=this.$dayjs(this.newSchedDate).startOf("isoWeek").format("YYYY-MM-DD");var t=new FormData;t.append("user_id",this.user.id),t.append("team_id",this.team.id),t.append("date_start",this.newSchedDate),r.a.post("/api/schedules",t).then((function(t){e.showSnackbar(e.$t("schedules.success_create_schedule"),"success"),e.getSchedData()}))}this.newSchedDate="",this.close()}}},d=a(8),u=a(9),h=a.n(u),v=a(103),f=a(221),m=a(5),_=a(658),p=a(660),w=a(639),b=a(638),k=a(661),x=a(113),D=a(225),g=a(659),S=a(657),$=a(51),y=a(42),V=a(23),C=Object(d.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-row",[a("PageTitle",{attrs:{title:e.$t("schedules.shift_schedules")}})],1),e._v(" "),a("v-card",{attrs:{width:"100%"}},[a("v-data-table",{attrs:{headers:e.schedHeaders,items:e.schedData,"sort-by":"date_start","sort-desc":""},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{directives:[{name:"show",rawName:"v-show",value:e.$vuetify.breakpoint.smAndUp,expression:"$vuetify.breakpoint.smAndUp"}]},[e._v(e._s(e.$t("schedules.shift_schedules")))]),e._v(" "),a("v-spacer"),e._v(" "),a("v-btn",{staticClass:"mb-2",attrs:{color:"secondary",block:e.$vuetify.breakpoint.xs},on:{click:function(t){e.dialog=!0}}},[a("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-calendar-plus")]),e._v("\n            "+e._s(e.$t("schedules.create_new_schedule"))+"\n          ")],1),e._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.$t("schedules.create_new_schedule")))])]),e._v(" "),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":e.date,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(t){e.date=t},"update:return-value":function(t){e.date=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:e.$t("schedules.choose_start_date"),"prepend-icon":"mdi-calendar",readonly:""},model:{value:e.newSchedDate,callback:function(t){e.newSchedDate=t},expression:"newSchedDate"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),a("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:e.locale,"first-day-of-week":e.$dayjs().localeData().firstDayOfWeek(),"allowed-dates":e.allowedDates},model:{value:e.newSchedDate,callback:function(t){e.newSchedDate=t},expression:"newSchedDate"}},[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(e._s(e.$t("general.cancel")))]),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.date)}}},[e._v(e._s(e.$t("general.ok")))])],1)],1)],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(e._s(e.$t("general.cancel")))]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v(e._s(e.$t("general.create")))])],1)],1)],1)],1)]},proxy:!0},{key:"item.date_start",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(e._f("formatDate")(a.date_start))+"\n      ")]}},{key:"item.status",fn:function(t){var n=t.item;return[a("div",{class:e.scheduleStatus[n.status].color+"--text"},[e._v(e._s(e.scheduleStatus[n.status].text))])]}},{key:"item.shifts_count",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.shifts_count)+"\n      ")]}},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.editSched(n)}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-pencil")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",small:"",disabled:n.status<1},on:{click:function(t){return e.editAssignments(n)}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-account-multiple-plus")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.deleteSched(n)}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1)]}}])})],1)],1)}),[],!1,null,null,null);t.default=C.exports;h()(C,{VBtn:v.a,VCard:f.a,VCardActions:m.a,VCardText:m.c,VCardTitle:m.d,VCol:_.a,VContainer:p.a,VDataTable:w.a,VDatePicker:b.a,VDialog:k.a,VIcon:x.a,VMenu:D.a,VRow:g.a,VSpacer:S.a,VTextField:$.a,VToolbar:y.a,VToolbarTitle:V.a})}}]);