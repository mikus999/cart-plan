(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{216:function(t,a,e){(a=e(10)(!1)).push([t.i,".translation-label[data-v-1a69fc41]{color:var(--v-primary-base)}",""]),t.exports=a},84:function(t,a,e){"use strict";e.r(a);var n=e(1),r=e.n(n),s=e(6),i=e.n(s);function l(t,a,e,n,r,s,i){try{var l=t[s](i),o=l.value}catch(t){return void e(t)}l.done?a(o):Promise.resolve(o).then(n,r)}function o(t){return function(){var a=this,e=arguments;return new Promise((function(n,r){var s=t.apply(a,e);function i(t){l(s,n,r,i,o,"next",t)}function o(t){l(s,n,r,i,o,"throw",t)}i(void 0)}))}}var c={middleware:"auth",layout:"vuetify",mixins:[e(11).a],components:{},data:function(){return{languages:[],langSource:[],langTarget:[],langSourceCat:[],langTargetCat:[],langSourceStrings:[],langTargetStrings:[],langSourceLocale:"en",langTargetLocale:null,currSection:null,validation:{name:{success:!1,message:null}},saveFab:{icon:"mdi-content-save",color:"primary",showTime:!0,autoSave:!0,interval_ms:3e4,interval_ends:null,interval1_rem:null,interval1:null,interval2:null}}},created:function(){this.getLanguages(),this.getStrings(this.langSourceLocale,!0)},methods:{getLanguages:function(){var t=this;return o(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i()({method:"get",url:"/api/translation/permissions"}).then((function(a){t.languages=a.data,t.languages=t.languages.filter((function(t){return"en"!=t.code}))}));case 2:case"end":return a.stop()}}),a)})))()},getMessages:function(){this.langTarget=[],this.langTargetStrings=[],this.currSection=null,this.getStrings(this.langTargetLocale,!1)},getFinishedPct:function(t){var a=Object.keys(this.langSource[t]).length,e=null==this.langTarget[t]?0:Object.keys(this.langTarget[t]).length,n=parseInt(e/a*100);return n>100&&(n=100),n},getCategoryColor:function(t){var a=this.getFinishedPct(t);return 0==a?"red":a<100?"yellow":"green"},getStrings:function(t,a){var e=this;return o(r.a.mark((function n(){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i()({method:"get",url:"/api/translation/strings/"+t}).then((function(t){a?e.langSource=t.data:e.langTarget=t.data,e.getCategories()}));case 2:case"end":return n.stop()}}),n)})))()},getCategories:function(){var t=this;this.langSourceCat=[],this.langTargetCat=[],Object.keys(this.langSource).forEach((function(a){t.langSourceCat.push({text:a,value:a})})),Object.keys(this.langTarget).forEach((function(a){t.langTargetCat.push({text:a,value:a})}))},parseStrings:function(t){var a=this;null!==this.currSection&&this.updateStrings(),this.currSection=t;var e=this.langSource[t];this.langSourceStrings=[],void 0===this.langTarget[t]&&this.$set(this.langTarget,t,{});var n=this.langTarget[t];this.langTargetStrings=[],Object.keys(e).forEach((function(t){a.langSourceStrings.push({key:t,value:e[t]}),a.langTargetStrings.push({key:t,value:void 0===n[t]?"":n[t]})})),this.saveFab.autoSave&&this.setSaveInterval()},setSaveInterval:function(){var t=this;null!==this.saveFab.interval1&&window.clearInterval(this.saveFab.interval1),this.startTimer(),this.saveFab.interval1=window.setInterval((function(){t.startTimer(),t.updateStrings()}),this.saveFab.interval_ms)},startTimer:function(){var t=this;this.saveFab.interval_ends=this.$dayjs().add(this.saveFab.interval_ms,"ms"),window.clearInterval(this.saveFab.interval2),this.saveFab.interval2=window.setInterval((function(){t.saveFab.interval1_rem=Math.round(-1*t.$dayjs().diff(t.saveFab.interval_ends)/1e3)}),1e3)},stopTimer:function(){window.clearInterval(this.saveFab.interval1),window.clearInterval(this.saveFab.interval2),this.saveFab.interval_ends=null,this.saveFab.interval1_rem=null,this.saveFab.interval1=null,this.saveFab.interval2=null,this.toggleFab(!0,!1)},saveNow:function(){null!==this.currSection&&(this.stopTimer(),this.updateStrings(),this.saveFab.autoSave&&this.setSaveInterval())},updateStrings:function(){var t=this;return o(r.a.mark((function a(){var e,n,s;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=t.currSection,n=t.langTargetLocale,s=t.langTargetStrings,t.toggleFab(!1,!1),setTimeout((function(){t.toggleFab(!0,t.saveFab.autoSave)}),2e3),a.next=7,i()({method:"post",url:"/api/translation/update",data:{section:e,lang:n,strings:JSON.stringify(s)}}).then((function(a){t.langTarget=a.data}));case 7:case"end":return a.stop()}}),a)})))()},toggleAutoSave:function(t){t?null!==this.currSection&&(this.setSaveInterval(),this.toggleFab(!0,!0)):this.stopTimer()},toggleFab:function(t,a){this.saveFab.color=t?"primary":"green",this.saveFab.icon=t?"mdi-content-save":"mdi-check-bold",this.saveFab.showTime=a}}},u=e(2),g=e.n(u),v=e(216),h=e.n(v),d={insert:"head",singleton:!1},f=(g()(h.a,d),h.a.locals,e(8)),p=e(9),b=e.n(p),m=e(103),S=e(221),w=e(231),T=e(658),_=e(660),F=e(624),y=e(32),k=e(113),x=e(620),C=e(621),I=e(659),V=e(663),L=e(51),O=Object(f.a)(c,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-container",{attrs:{fluid:""}},[e("v-row",[e("PageTitle",{attrs:{title:t.$t("translation.management_system")}}),t._v(" "),e("div",{staticClass:"ml-auto"},[e("v-switch",{attrs:{label:t.$t("general.autosave")},on:{change:t.toggleAutoSave},model:{value:t.saveFab.autoSave,callback:function(a){t.$set(t.saveFab,"autoSave",a)},expression:"saveFab.autoSave"}})],1)],1),t._v(" "),e("v-card",{attrs:{width:"100%"}},[e("v-row",[e("v-col",{attrs:{cols:"12",sm:"6"}},[e("span",[t._v(t._s(t.$t("translation.source_language"))+": EN")])]),t._v(" "),e("v-col",{attrs:{cols:"12",sm:"6"}},[e("span",[t._v(t._s(t.$t("translation.target_language")))]),t._v(" "),e("v-radio-group",{attrs:{row:""},on:{change:t.getMessages},model:{value:t.langTargetLocale,callback:function(a){t.langTargetLocale=a},expression:"langTargetLocale"}},t._l(t.languages,(function(t){return e("v-radio",{key:t.id,attrs:{label:t.name,value:t.code}})})),1)],1)],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"12"}},[null!==t.langTargetLocale?e("div",t._l(t.langSourceCat,(function(a){return e("v-chip",{key:a.value,staticClass:"ma-2 font-weight-bold",attrs:{color:t.getCategoryColor(a.text)},on:{click:function(e){return t.parseStrings(a.value)}}},[t._v("\n            "+t._s(a.text+" "+t.getFinishedPct(a.text))+"%\n          ")])})),1):t._e()])],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"12"}},[null!==t.currSection?e("v-data-iterator",{attrs:{items:t.langSourceStrings,"hide-default-footer":"","disable-pagination":""},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.items,(function(n){return e("v-row",{key:n.key,staticClass:"mt-3"},[e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{hint:n.key,placeholder:"---","persistent-hint":"",prefix:t.langTargetLocale.toUpperCase()+": "},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",{staticClass:"translation-label"},[t._v("EN: "+t._s(n.value))])]},proxy:!0}],null,!0),model:{value:t.langTargetStrings[a.items.indexOf(n)].value,callback:function(e){t.$set(t.langTargetStrings[a.items.indexOf(n)],"value",e)},expression:"langTargetStrings[props.items.indexOf(item)].value"}})],1)],1)}))}}],null,!1,466438897)}):t._e()],1)],1)],1),t._v(" "),e("v-fab-transition",[e("v-btn",{key:t.saveFab.icon,attrs:{color:t.saveFab.color,fab:"",dark:"",bottom:"",right:"",fixed:""},on:{click:t.saveNow}},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.saveFab.showTime,expression:"saveFab.showTime"}]},[t._v(t._s(t.saveFab.interval1_rem))]),t._v(" "),e("v-icon",[t._v(t._s(t.saveFab.icon))])],1)],1)],1)}),[],!1,null,"1a69fc41",null);a.default=O.exports;b()(O,{VBtn:m.a,VCard:S.a,VChip:w.a,VCol:T.a,VContainer:_.a,VDataIterator:F.a,VFabTransition:y.c,VIcon:k.a,VRadio:x.a,VRadioGroup:C.a,VRow:I.a,VSwitch:V.a,VTextField:L.a})}}]);