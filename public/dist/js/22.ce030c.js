(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{126:function(e,t,s){"use strict";var a=s(1),n=s.n(a),i=s(6),r=s.n(i);function o(e,t,s,a,n,i,r){try{var o=e[i](r),c=o.value}catch(e){return void s(e)}o.done?t(c):Promise.resolve(c).then(a,n)}function c(e){return function(){var t=this,s=arguments;return new Promise((function(a,n){var i=e.apply(t,s);function r(e){o(i,a,n,r,c,"next",e)}function c(e){o(i,a,n,r,c,"throw",e)}r(void 0)}))}}var l={name:"MessageList",middleware:["auth","teams"],layout:"vuetify",mixins:[s(11).a],components:{},props:{editor:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!1}},data:function(){return{messages:[],base_url:"https://dev.sheepstand.com",apiInterval:null}},computed:{},created:function(){var e=this;this.getMessages(),this.apiInterval=window.setInterval((function(){e.getMessages()}),6e4)},beforeDestroy:function(){window.clearInterval(this.apiInterval)},methods:{getMessages:function(){var e=this;return c(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r()({method:"get",url:"/api/messages"}).then((function(t){e.messages=t.data.messages}));case 2:case"end":return t.stop()}}),t)})))()},deleteMessage:function(e){var t=this;return c(n.a.mark((function s(){return n.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.$root.$confirm(t.$t("messages.confirm_delete_message"),null,"error");case 2:if(!s.sent){s.next=5;break}return s.next=5,r()({method:"delete",url:"/api/messages/"+e}).then((function(e){t.showSnackbar(t.$t("messages.success_delete_message"),"success"),t.messages=e.data.messages}));case 5:case"end":return s.stop()}}),s)})))()},markAsRead:function(e){var t=this;return c(n.a.mark((function s(){return n.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r()({method:"get",url:"/api/messages/"+e+"/markread"}).then((function(e){t.messages=e.data.messages,t.$store.dispatch("general/scheduledTasks")}));case 2:case"end":return s.stop()}}),s)})))()},goToRoute:function(e){null!=e&&this.$router.push({name:e})}}},u=s(2),m=s.n(u),d=s(160),v=s.n(d),f={insert:"head",singleton:!1},g=(m()(v.a,f),v.a.locals,s(8)),h=s(9),p=s.n(h),_=s(103),w=s(221),b=s(5),k=s(226),x=s(113),y=s(227),V=s(114),I=s(220),L=s(18),$=s(224),C=s(228),T=Object(g.a)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",[e.showTitle?s("v-card-title",[e._v("\n    "+e._s(e.$t("messages.inbox"))+"\n  ")]):e._e(),e._v(" "),s("v-card-text",[s("v-list",{attrs:{flat:""}},[s("v-list-item-group",[s("v-divider"),e._v(" "),e._l(e.messages,(function(t,a){return[s("v-list-item",{key:t.id,nativeOn:{click:function(s){return e.markAsRead(t.id)}}},[s("v-list-item-avatar",[s("v-icon",[e._v(e._s(t.users.length>0?"mdi-email-open":"mdi-email"))])],1),e._v(" "),s("v-list-item-content",{class:t.users.length>0?"":"font-weight-black"},[s("v-list-item-title",[e._v("\n                  "+e._s(t.system_message?"SheepStand":t.team.display_name)+"\n                ")]),e._v(" "),s("v-list-item-subtitle",{staticClass:"word-wrap"},[e._v("\n                  "+e._s(t.system_message?e.$t(t.message_i18n_string):t.message_text)+"\n                ")])],1),e._v(" "),s("v-list-item-action",[s("v-list-item-action-text",{staticClass:"mb-auto"},[e._v("\n                "+e._s(e._f("formatDate")(t.created_at))+"\n              ")]),e._v(" "),s("div",{staticClass:"my-auto"},[t.named_route?s("v-btn",{staticClass:"mb-n2",attrs:{icon:"",small:"",to:{name:t.named_route}}},[s("v-icon",{attrs:{small:""}},[e._v("mdi-link")])],1):e._e(),e._v(" "),e.editor?s("v-btn",{attrs:{icon:"",small:""},on:{click:function(s){return e.deleteMessage(t.id)}}},[s("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1):e._e()],1)],1)],1),e._v(" "),a<e.messages.length-1?s("v-divider",{key:"div-"+t.id}):e._e()]}))],2)],1)],1)],1)}),[],!1,null,"4ec4b28d",null);t.a=T.exports;p()(T,{VBtn:_.a,VCard:w.a,VCardText:b.c,VCardTitle:b.d,VDivider:k.a,VIcon:x.a,VList:y.a,VListItem:V.a,VListItemAction:I.a,VListItemActionText:L.a,VListItemAvatar:$.a,VListItemContent:L.b,VListItemGroup:C.a,VListItemSubtitle:L.c,VListItemTitle:L.d})},160:function(e,t,s){(t=s(10)(!1)).push([e.i,".word-wrap[data-v-4ec4b28d]{-webkit-line-clamp:unset!important;white-space:normal}",""]),e.exports=t},172:function(e,t,s){"use strict";s.r(t);var a=s(11),n=s(126),i={middleware:["auth"],layout:"vuetify",mixins:[a.a],components:{MessageList:n.a},data:function(){return{messageList_key:1}}},r=s(8),o=s(9),c=s.n(o),l=s(658),u=s(660),m=s(659),d=Object(r.a)(i,(function(){var e=this.$createElement,t=this._self._c||e;return t("v-container",{attrs:{fluid:""}},[t("v-row",[t("PageTitle",{attrs:{title:this.$t("messages.inbox")}})],1),this._v(" "),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("MessageList",{key:this.messageList_key})],1)],1)],1)}),[],!1,null,null,null);t.default=d.exports;c()(d,{VCol:l.a,VContainer:u.a,VRow:m.a})}}]);