(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{165:function(t,e,a){"use strict";a.r(e);var s=a(6),i=a.n(s),n=a(11),r=a(1),o=a.n(r),l=a(316),c=a.n(l);function u(t,e,a,s,i,n,r){try{var o=t[n](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,i)}var f={name:"ShiftStatistics",mixins:[n.a],components:{VueApexCharts:c.a},data:function(){var t,e,a,s=this;return{stats:[],seriesPlaces:[],optionsPlaces:(t={chart:{height:350,type:"radialBar"},labels:["Available Spots","Trades"],colors:["#2196F3","#00BCD4"],fill:{type:"gradient",gradient:{shade:"dark",type:"vertical",shadeIntensity:.5,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,100]}},stroke:{lineCap:"round"},plotOptions:{radialBar:{hollow:{margin:0,size:"40%",background:"#222222",image:void 0,position:"front",dropShadow:{enabled:!0,top:0,left:0,blur:4,opacity:.24}},track:{background:["#BBDEFB","#E0F7FA"]},dataLabels:{name:{fontSize:"14px"},value:{fontSize:"14px",color:"#ffffff",formatter:function(t){return Math.round(t/100*s.stats.total_spots)}},total:{show:!0,label:"Total Spots",fontSize:"14px",color:"#ffffff",formatter:function(t){return s.stats.total_spots}}}}}},e="stroke",a={lineCap:"round"},e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t),seriesShifts:[],optionsShifts:{chart:{height:350,type:"radialBar"},labels:["Shift with Needs","Shifts with Trades"],colors:["#2196F3","#00BCD4"],fill:{type:"gradient",gradient:{shade:"dark",type:"vertical",shadeIntensity:.5,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,100]}},stroke:{lineCap:"round"},plotOptions:{radialBar:{hollow:{margin:0,size:"40%",background:"#222222",image:void 0,position:"front",dropShadow:{enabled:!0,top:0,left:0,blur:4,opacity:.24}},track:{background:["#BBDEFB","#E0F7FA"]},dataLabels:{name:{fontSize:"14px"},value:{fontSize:"14px",color:"#ffffff",formatter:function(t){return Math.round(t/100*s.stats.total_shifts)}},total:{show:!0,label:"Total Shifts",fontSize:"14px",color:"#ffffff",formatter:function(t){return s.stats.total_shifts}}}}}}}},created:function(){var t=this;if(this.team)this.getStats();else var e=this.$store.subscribe((function(a,s){"auth/SET_TEAM"===a.type&&(t.getStats(),e())}))},methods:{getStats:function(){var t,e=this;return(t=o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.get("/api/teams/"+e.team.id+"/stats").then((function(t){e.stats=t.data.stats;var a=e.stats.available_spots/e.stats.total_spots*100,s=e.stats.available_trades/e.stats.total_spots*100;e.seriesPlaces.push(a),e.seriesPlaces.push(s);var i=e.stats.shifts_with_needs/e.stats.total_shifts*100,n=e.stats.shifts_with_trades/e.stats.total_shifts*100;e.seriesShifts.push(i),e.seriesShifts.push(n)}));case 2:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(s,i){var n=t.apply(e,a);function r(t){u(n,s,i,r,o,"next",t)}function o(t){u(n,s,i,r,o,"throw",t)}r(void 0)}))})()}}},h=a(8),d=a(9),v=a.n(d),m=a(221),p=a(658),_=a(113),y=a(659),b=a(42),w=a(23),x=Object(h.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("v-icon",{attrs:{left:""}},[t._v("mdi-gauge")]),t._v("\n        "+t._s(t.$t("general.statistics"))+"\n      ")],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-center",attrs:{sm:"6",lg:"12"}},[a("VueApexCharts",{attrs:{options:t.optionsPlaces,series:t.seriesPlaces,width:"100%"}})],1),t._v(" "),a("v-col",{staticClass:"text-center",attrs:{sm:"6",lg:"12"}},[a("VueApexCharts",{attrs:{options:t.optionsShifts,series:t.seriesShifts,width:"100%"}})],1)],1)],1)}),[],!1,null,null,null),g=x.exports;v()(x,{VCard:m.a,VCol:p.a,VIcon:_.a,VRow:y.a,VToolbar:b.a,VToolbarTitle:w.a});var k=a(73);function S(t,e,a,s,i,n,r){try{var o=t[n](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,i)}function T(t){return function(){var e=this,a=arguments;return new Promise((function(s,i){var n=t.apply(e,a);function r(t){S(n,s,i,r,o,"next",t)}function o(t){S(n,s,i,r,o,"throw",t)}r(void 0)}))}}var O={name:"TradeRequests",mixins:[n.a],components:{ShiftCard:k.a},data:function(){return{shiftOverlay:!1,shift:null,schedule:null,trades:[],headersShift:[{text:this.$t("shifts.day"),value:"day",align:"left"},{text:this.$t("shifts.location"),value:"location",align:"left"},{text:this.$t("shifts.trade_requests"),value:"tradewith",align:"left"},{text:"",value:"view",align:"left"}]}},created:function(){var t=this;if(this.team)this.getTrades();else var e=this.$store.subscribe((function(a,s){"auth/SET_TEAM"===a.type&&(t.getTrades(),e())}))},methods:{getTrades:function(){var t=this;return T(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get("/api/teams/"+t.team.id+"/trades").then((function(e){t.trades=e.data.trades}));case 2:case"end":return e.stop()}}),e)})))()},makeTrade:function(t){var e=this;return T(o.a.mark((function a(){return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$root.$confirm(e.$t("shifts.confirm_trade"),null,"primary");case 2:if(!a.sent){a.next=5;break}return a.next=5,i()({method:"post",url:"/api/teams/"+e.team.id+"/trades",data:{shift_id:t.pivot.shift_id,user_id:t.pivot.user_id}}).then((function(t){e.trades=t.data.trades.trades,e.showSnackbar(e.$t("shifts.success_trade_made"),"success")}));case 5:case"end":return a.stop()}}),a)})))()},showShiftOverlay:function(t){this.shift=t,this.schedule=t.schedule,this.shiftOverlay=!0}}},V=a(103),$=a(231),C=a(639),B=a(232),P=Object(h.a)(O,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-data-table",{attrs:{headers:t.headersShift,items:t.trades,"disable-sort":"",width:"100%"},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("v-icon",{attrs:{left:""}},[t._v("mdi-account-convert")]),t._v("\n          "+t._s(t.$t("shifts.trade_requests"))+"\n        ")],1)],1)]},proxy:!0},{key:"item.day",fn:function(e){var s=e.item;return[t._v("\n      "+t._s(t._f("formatDay")(s.time_start))),a("br"),t._v("\n      "+t._s(t._f("formatTime")(s.time_start))+" - "+t._s(t._f("formatTime")(s.time_end))+"\n    ")]}},{key:"item.shift_time",fn:function(t){t.item}},{key:"item.location",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{label:"",small:"",color:s.location.color_code}},[t._v(t._s(s.location.name))])]}},{key:"header.tradewith",fn:function(e){e.header;return[t._v("\n      "+t._s(t.$t("shifts.trade_requests"))),a("br"),t._v("\n      "+t._s(t.$t("shifts.trade_click_to_accept"))+"\n    ")]}},{key:"item.tradewith",fn:function(e){var s=e.item;return t._l(s.trades,(function(e){return a("v-chip",{key:e.id,staticClass:"me-2",attrs:{color:"blue",label:"",small:"",disabled:e.id===t.user.id,outlined:e.id===t.user.id},on:{click:function(a){return t.makeTrade(e)}}},[a("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-swap-horizontal-bold")]),t._v("\n         "+t._s(e.name)+"\n      ")],1)}))}},{key:"item.view",fn:function(e){var s=e.item;return[a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showShiftOverlay(s)}}},[a("v-icon",[t._v("mdi-card-account-details-outline")])],1)]}}])}),t._v(" "),a("v-overlay",{attrs:{value:t.shiftOverlay,dark:"dark"==t.theme}},[a("ShiftCard",{attrs:{shift:t.shift,schedule:t.schedule,onlyinfo:"",width:"300px",height:"100%"},on:{close:function(e){t.shiftOverlay=!1}}})],1)],1)}),[],!1,null,null,null),E=P.exports;v()(P,{VBtn:V.a,VCard:m.a,VChip:$.a,VDataTable:C.a,VIcon:_.a,VOverlay:B.a,VToolbar:b.a,VToolbarTitle:w.a});var A=a(48),z=a(92);function F(t,e,a,s,i,n,r){try{var o=t[n](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,i)}function D(t){return function(){var e=this,a=arguments;return new Promise((function(s,i){var n=t.apply(e,a);function r(t){F(n,s,i,r,o,"next",t)}function o(t){F(n,s,i,r,o,"throw",t)}r(void 0)}))}}var M={name:"MyShifts",mixins:[n.b,n.c,A.b],props:{},components:{ShiftCard:k.a,Leaflet:z.a},data:function(){return{expanded:[],shiftOverlay:!1,locationOverlay:!1,shift:null,schedule:null,location:null,shifts:[],shiftsAll:[],allTeams:!1,headers:[{text:this.$t("teams.team_name"),value:"schedule.team.display_name",align:"left"},{text:this.$t("shifts.day"),value:"day",align:"left"},{text:this.$t("shifts.location"),value:"location",align:"left"},{text:this.$t("general.actions"),value:"view"}]}},computed:{mapWidth:function(){return this.$vuetify.breakpoint.width<500?this.$vuetify.breakpoint.width-50+"px":"500px"}},created:function(){this.getShifts()},methods:{getShifts:function(){var t=this;return D(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get("/api/user/shifts").then((function(e){t.shiftsAll=e.data,t.shifts=e.data.filter((function(e){return e.schedule.team_id===t.team.id}))}));case 2:case"end":return e.stop()}}),e)})))()},update:function(){var t=this;this.allTeams?this.shifts=this.shiftsAll:this.shifts=this.shiftsAll.filter((function(e){return e.schedule.team_id===t.team.id}))},showShiftOverlay:function(t){this.shift=t,this.schedule=t.schedule,this.shiftOverlay=!0},showLocationOverlay:function(t){this.location=t.location,this.locationOverlay=!0},showTradeButton:function(t){var e=this,a=null,s=t.users.filter((function(t){return t.id===e.user.id}));return s.length>0&&(a=s[0].pivot.status),2==t.schedule.status&&a>1},updateTrade:function(t){var e=this;return D(o.a.mark((function a(){var s,n,r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.t0=4==t.pivot.status,a.t0){a.next=5;break}return a.next=4,e.$root.$confirm(e.$t("shifts.confirm_trade_offer"),null,"info");case 4:a.t0=a.sent;case 5:if(!a.t0){a.next=16;break}if(s=4==t.pivot.status?2:4,!e.notificationsEnabled||4!=s){a.next=14;break}return n=e.message_trade_offer(e.user.name,t.time_start,t.time_end,t.location.name),r=e.team.notificationsettings.telegram_channel_id,a.next=12,e.mtInitialize();case 12:return a.next=14,e.sendMessage(r,n);case 14:return a.next=16,i()({method:"post",url:"/api/schedules/shiftuserstatus",data:{user_id:e.user.id,shift_id:t.id,status:s}}).then((function(t){e.getShifts()}));case 16:case"end":return a.stop()}}),a)})))()}}},q=a(663),I=Object(h.a)(M,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-data-table",{attrs:{headers:t.headers,items:t.shifts,"disable-sort":"",width:"100%"},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("v-icon",{attrs:{left:""}},[t._v("mdi-calendar-account")]),t._v("\n          "+t._s(t.$t("shifts.my_shifts"))+"\n        ")],1)],1),t._v(" "),a("v-switch",{staticClass:"mx-4",attrs:{label:t.$t("shifts.show_all_teams"),"hide-details":""},on:{change:t.update},model:{value:t.allTeams,callback:function(e){t.allTeams=e},expression:"allTeams"}})]},proxy:!0},{key:"item.day",fn:function(e){var s=e.item;return[t._v("\n      "+t._s(t._f("formatDay")(s.time_start))),a("br"),t._v("\n      "+t._s(t._f("formatTime")(s.time_start))+" - "+t._s(t._f("formatTime")(s.time_end))+"\n    ")]}},{key:"item.location",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{label:"",small:"",color:s.location.color_code},on:{click:function(e){return t.showLocationOverlay(s)}}},[t._v(t._s(s.location.name))])]}},{key:"item.view",fn:function(e){var s=e.item;return[a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showShiftOverlay(s)}}},[a("v-icon",[t._v("mdi-card-account-details-outline")])],1),t._v(" "),a("v-btn",{attrs:{icon:"",disabled:!t.showTradeButton(s),color:4==s.pivot.status?"blue":""},on:{click:function(e){return e.stopPropagation(),t.updateTrade(s)}}},[a("v-icon",[t._v("mdi-account-convert")])],1)]}}])}),t._v(" "),a("v-overlay",{attrs:{value:t.shiftOverlay,dark:"dark"==t.theme}},[a("ShiftCard",{attrs:{shift:t.shift,schedule:t.schedule,onlyinfo:"",width:"300px",height:"100%"},on:{close:function(e){t.shiftOverlay=!1}}})],1),t._v(" "),a("v-overlay",{attrs:{value:t.locationOverlay,dark:"dark"==t.theme},nativeOn:{click:function(e){t.locationOverlay=!1}}},[a("Leaflet",{attrs:{location:t.location,width:t.mapWidth,height:"500px",readonly:""},on:{close:function(e){t.locationOverlay=!1}},nativeOn:{click:function(t){t.stopPropagation()}}})],1)],1)}),[],!1,null,null,null),L=I.exports;v()(I,{VBtn:V.a,VCard:m.a,VChip:$.a,VDataTable:C.a,VIcon:_.a,VOverlay:B.a,VSwitch:q.a,VToolbar:b.a,VToolbarTitle:w.a});var j=a(135),R={middleware:["auth","teams"],layout:"vuetify",mixins:[n.a],components:{ShiftStatistics:g,TradeRequests:E,MyShifts:L,NotificationJoin:j.a}},J=a(660),N=a(657),W=Object(h.a)(R,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-row",[a("PageTitle",{attrs:{title:t.$t("general.home")}})],1),t._v(" "),a("v-row"),t._v(" "),t.user?a("v-row",[a("v-col",{attrs:{cols:"12",lg:"8"}},[a("MyShifts"),t._v(" "),a("v-spacer",{staticClass:"my-12"}),t._v(" "),a("TradeRequests")],1),t._v(" "),a("v-col",{attrs:{cols:"12",lg:"4"}})],1):t._e()],1)}),[],!1,null,null,null);e.default=W.exports;v()(W,{VCol:p.a,VContainer:J.a,VRow:y.a,VSpacer:N.a})}}]);